{
  "variables": {
    "MAMEGREP_HIDE_LEGEND": {
      "type": "env",
      "default": false,
    },
  },
  "setup": {
    "context": "@main",
    "action": {
      "type": "init-legend",
      "hide": {"ref": "MAMEGREP_HIDE_LEGEND"},
      "labels": {"show": "s(H)ow", "hide": "(H)ide"},
    },
  },
  "keybindings": {
    "@main": [
      {
        "label": "(q)uit     [ESC,C-c]",
        "keys": ["q", "<ESCAPE>", "C-c"],
        "action": {"type": "quit"},
      },
      {
        "keys": ["H"],
        "action": {"type": "toggle-legend"},
      },
      // Focus switching
      {
        "label": "(e)dit pattern   [/]",
        "keys": ["/", "e"],
        "action": {"type": "set-focus", "focus": "pattern"},
        "context": "@editing",
      },
      {
        "label": "edit (a)nd pattern  ",
        "keys": ["a"],
        "action": {"type": "set-focus", "focus": "and-pattern"},
        "context": "@editing",
      },
      {
        "label": "edit (n)ot pattern  ",
        "keys": ["n"],
        "action": {"type": "set-focus", "focus": "not-pattern"},
        "context": "@editing",
      },
      {
        "label": "edit (r)evision     ",
        "keys": ["r"],
        "action": {"type": "set-focus", "focus": "revision"},
        "context": "@editing",
      },
      {
        "label": "edit (p)ath         ",
        "keys": ["p"],
        "action": {"type": "set-focus", "focus": "path"},
        "context": "@editing",
      },
      // Navigation
      {
        "label": "(↑)          [k,C-p]",
        "keys": ["k", "C-p", "<UP>"],
        "action": {"type": "cursor-up"},
      },
      {
        "label": "(↓)          [j,C-n]",
        "keys": ["j", "C-n", "<DOWN>"],
        "action": {"type": "cursor-down"},
      },
      {
        "label": "(←)          [h,C-b]",
        "keys": ["h", "C-b", "<LEFT>"],
        "action": {"type": "cursor-left"},
      },
      {
        "label": "(→)          [l,C-f]",
        "keys": ["l", "C-f", "<RIGHT>"],
        "action": {"type": "cursor-right"},
      },
      // Expansion
      {
        "label": "(t)oggle file  [TAB]",
        "keys": ["t", "<TAB>"],
        "action": {"type": "toggle-expansion"},
      },
      {
        "label": "(T)oggle all files  ",
        "keys": ["T"],
        "action": {"type": "toggle-all-expansion"},
      },
      // Grep flags
      {
        "keys": ["i"],
        "action": {"type": "flip-ignore-case"},
      },
      {
        "keys": ["w"],
        "action": {"type": "flip-whole-word"},
      },
      {
        "keys": ["E"],
        "action": {"type": "flip-extended-regexp"},
      },
      {
        "keys": ["F"],
        "action": {"type": "flip-fixed-strings"},
      },
      {
        "keys": ["P"],
        "action": {"type": "flip-perl-regexp"},
      },
      {
        "keys": ["v"],
        "action": {"type": "flip-invert-match"},
      },
    ],
    "@editing": [
      {
        "label": "quit       [ESC,C-c]",
        "keys": ["<ESCAPE>", "C-c"],
        "action": {"type": "quit"},
      },

      // Text editing commands
      {
        "keys": ["<ENTER>"],
        "action": {"type": "accept-input"},
        "context": "@main",
      },
      {
        "keys": ["C-g"],
        "action": {"type": "set-focus", "focus": "search-result"},
        "context": "@main",
      },
      {
        "keys": ["<TAB>"],
        // TODO: regrep
        "action": {"type": "set-focus", "focus": "search-result"},
      },
      {
        "keys": ["<BACKSPACE>", "C-h"],
        "action": {"type": "delete-backward"},
      },
      {
        "keys": ["C-d", "<DELETE>"],
        "action": {"type": "delete-char"},
      },
      {
        "keys": ["C-b"],
        "action": {"type": "move-backward"},
      },
      {
        "keys": ["C-f"],
        "action": {"type": "move-forward"},
      },
      {
        "keys": ["C-a"],
        "action": {"type": "move-to-start"},
      },
      {
        "keys": ["C-e"],
        "action": {"type": "move-to-end"},
      },
      {
        "keys": ["C-k"],
        "action": {"type": "delete-to-end"},
      },
      {
        "keys": ["C-u"],
        "action": {"type": "clear-arg"},
      },
      {
        "keys": ["<PRINTABLE>"],
        "action": {"type": "insert-char"},
      },
    ],
  },
}
